{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.defaultEditUserGroupProps = exports.CreateEditUserGroup = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _antd = require(\"antd\");\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _reduxReducerRegistry = _interopRequireDefault(require(\"@onaio/redux-reducer-registry\"));\n\nvar _notifications = require(\"@opensrp/notifications\");\n\nvar _Form = require(\"./Form\");\n\nvar _constants = require(\"../../constants\");\n\nvar _mls = require(\"../../mls\");\n\nvar _userGroups = require(\"../../ducks/userGroups\");\n\nvar _utils = require(\"../UserRolesList/utils\");\n\nvar _utils2 = require(\"./utils\");\n\nvar _userRoles = require(\"../../ducks/userRoles\");\n\n_reduxReducerRegistry[\"default\"].register(_userGroups.reducerName, _userGroups.reducer);\n\nvar userGroupsSelector = (0, _userGroups.makeKeycloakUserGroupsSelector)();\nvar userRolesSelector = (0, _userRoles.makeKeycloakUserRolesSelector)();\nvar defaultEditUserGroupProps = {\n  keycloakBaseURL: ''\n};\nexports.defaultEditUserGroupProps = defaultEditUserGroupProps;\n\nvar CreateEditUserGroup = function CreateEditUserGroup(props) {\n  var keycloakBaseURL = props.keycloakBaseURL;\n\n  var _React$useState = _react[\"default\"].useState(false),\n      _React$useState2 = (0, _slicedToArray2[\"default\"])(_React$useState, 2),\n      isLoading = _React$useState2[0],\n      setIsLoading = _React$useState2[1];\n\n  var _React$useState3 = _react[\"default\"].useState([]),\n      _React$useState4 = (0, _slicedToArray2[\"default\"])(_React$useState3, 2),\n      availableRoles = _React$useState4[0],\n      setAvailableRoles = _React$useState4[1];\n\n  var _React$useState5 = _react[\"default\"].useState([]),\n      _React$useState6 = (0, _slicedToArray2[\"default\"])(_React$useState5, 2),\n      assignedRoles = _React$useState6[0],\n      setAssignedRoles = _React$useState6[1];\n\n  var _useTranslation = (0, _mls.useTranslation)(),\n      t = _useTranslation.t;\n\n  var dispatch = (0, _reactRedux.useDispatch)();\n  var userGroupId = props.match.params[_constants.ROUTE_PARAM_USER_GROUP_ID];\n  var keycloakUserGroup = (0, _reactRedux.useSelector)(function (state) {\n    return userGroupsSelector(state, {\n      id: [userGroupId]\n    });\n  });\n  var allRoles = (0, _reactRedux.useSelector)(function (state) {\n    return userRolesSelector(state, {});\n  });\n  var initialValues = keycloakUserGroup.length ? keycloakUserGroup[0] : _Form.defaultInitialValues;\n\n  _react[\"default\"].useEffect(function () {\n    if (userGroupId) {\n      setIsLoading(true);\n      var groupPromise = (0, _utils2.fetchSingleGroup)(userGroupId, keycloakBaseURL, dispatch, t);\n      var allRolesPromise = (0, _utils.fetchAllRoles)(keycloakBaseURL, dispatch, t);\n      var availableRolesPromise = (0, _utils2.fetchRoleMappings)(userGroupId, keycloakBaseURL, _constants.KEYCLOAK_URL_AVAILABLE_ROLES, setAvailableRoles, t);\n      var assignedRolesPromise = (0, _utils2.fetchRoleMappings)(userGroupId, keycloakBaseURL, _constants.KEYCLOAK_URL_ASSIGNED_ROLES, setAssignedRoles, t);\n      Promise.all([groupPromise, allRolesPromise, availableRolesPromise, assignedRolesPromise])[\"catch\"](function () {\n        return (0, _notifications.sendErrorNotification)(t('There was a problem fetching user groups'));\n      })[\"finally\"](function () {\n        return setIsLoading(false);\n      });\n    }\n  }, [initialValues.id, props.location]);\n\n  if (isLoading) {\n    return _react[\"default\"].createElement(_antd.Spin, {\n      size: \"large\",\n      className: \"custom-spinner\"\n    });\n  }\n\n  var userGroupFormProps = {\n    allRoles: allRoles,\n    assignedRoles: assignedRoles,\n    availableRoles: availableRoles,\n    initialValues: initialValues,\n    keycloakBaseURL: keycloakBaseURL\n  };\n  return _react[\"default\"].createElement(_antd.Row, null, _react[\"default\"].createElement(_antd.Col, {\n    span: 24\n  }, _react[\"default\"].createElement(_Form.UserGroupForm, userGroupFormProps)));\n};\n\nexports.CreateEditUserGroup = CreateEditUserGroup;\nCreateEditUserGroup.defaultProps = defaultEditUserGroupProps;","map":null,"metadata":{},"sourceType":"script"}