{"ast":null,"code":"var util = require(\"./utilities\");\n\nvar _require = require(\"./types\"),\n    ResourceNode = _require.ResourceNode;\n\nvar makeResNode = ResourceNode.makeResNode;\nvar engine = {};\n\nengine.children = function (coll) {\n  var model = this.model; // \"this\" is the context object\n\n  return coll.reduce(function (acc, x) {\n    var d = util.valData(x);\n    x = makeResNode(x);\n\n    if (typeof d === 'object') {\n      for (var _i = 0, _Object$keys = Object.keys(d); _i < _Object$keys.length; _i++) {\n        var prop = _Object$keys[_i];\n        var v = d[prop];\n        var childPath = x.path + '.' + prop;\n\n        if (model) {\n          var defPath = model.pathsDefinedElsewhere[childPath];\n          if (defPath) childPath = defPath;\n        }\n\n        if (Array.isArray(v)) {\n          acc.push.apply(acc, v.map(function (n) {\n            return makeResNode(n, childPath);\n          }));\n        } else {\n          acc.push(makeResNode(v, childPath));\n        }\n      }\n\n      return acc;\n    } else {\n      return acc;\n    }\n  }, []);\n};\n\nengine.descendants = function (coll) {\n  var ch = engine.children.call(this, coll); // \"this\" is the context object\n\n  var res = [];\n\n  while (ch.length > 0) {\n    res.push.apply(res, ch);\n    ch = engine.children.call(this, ch);\n  }\n\n  return res;\n};\n\nmodule.exports = engine;","map":null,"metadata":{},"sourceType":"script"}