{"ast":null,"code":"var engine = {};\n\nconst types = require('./types');\n\nconst constants = require('./constants');\n\nconst FP_DateTime = types.FP_DateTime;\n/**\n *  Implements FHIRPath now().\n */\n\nengine.now = function () {\n  if (!constants.now) {\n    // return new FP_DateTime((new Date()).toISOString());\n    // The above would construct an FP_DateTime with a timezone of \"Z\", which\n    // would not make a difference for computation, but if the end result of an\n    // expression is \"now()\", then it would look different when output to a user.\n    // Construct it ourselves to preserve timezone\n    var now = constants.nowDate; // a JS Date\n\n    var isoStr = FP_DateTime.isoDateTime(now);\n    constants.now = new FP_DateTime(isoStr);\n  }\n\n  return constants.now;\n};\n/**\n *  Implements FHIRPath today().  See comments in now(). This does not\n *  include a timezone offset.\n */\n\n\nengine.today = function () {\n  if (!constants.today) {\n    // Construct the string ourselves to preserve timezone\n    var now = constants.nowDate; // a JS Date\n\n    var isoStr = FP_DateTime.isoDate(now);\n    constants.today = new FP_DateTime(isoStr);\n  }\n\n  return constants.today;\n};\n\nmodule.exports = engine;","map":null,"metadata":{},"sourceType":"script"}